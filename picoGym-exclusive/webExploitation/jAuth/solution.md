# JAuth

## Problem

Most web application developers use third party components without testing their security. Some of the past affected companies are:

* Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
* Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
* VerticalScope (internet media company) - outdated version of vBulletin forum software used

Can you identify the components and exploit the vulnerable one? The website is running [here](http://saturn.picoctf.net:49697/). Can you become an admin? You can login as *test* with the password *Test123!* to get started.

## Links

* [Website link](http://saturn.picoctf.net:49697/)

## Notes

The webpage is a plain looking login page.  Typing in the password takes us to a new page `http://saturn.picoctf.net:49697/private`.  It seems that the thing keeping track of autherization is a cookie that is passed back as response from the `http://saturn.picoctf.net:49697/auth` POST route that the form on the index.html page sends too.

Here is an example of that token,

```text
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNjYwNjE3OTg2OTE2LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IFVidW50dTsgTGludXggeDg2XzY0OyBydjoxMDMuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDMuMCIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNjYwNjE3OTg3fQ.rvi2Ixtg8Z5jMfgJ2DFgiXwBlerYyYro7_0NlTF8PdM;
```

Changing this from base64 we get

```text
{"typ":"JWT","alg":"HS256"}{"auth":1660617986916,"agent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:103.0) Gecko/20100101 Firefox/103.0","role":"user","iat":1660617987}
ï.b1¶..æ3.......À.^...®.ô6TÅð÷L
```

It seems that based on the description of this challange the goal will be to modify the JWT to make the site think we are an admin.  I will refer to this site guide [Hacking JSON Web Tokens (JWTs)](https://medium.com/swlh/hacking-json-web-tokens-jwts-9122efe91e4a) to see if I can solve this challange.



## Solution

Answer
