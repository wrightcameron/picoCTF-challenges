# More Cookies

## Problem

Need to provide a more indepth breakdown of the solution .. before you forget.

I forgot Cookies can Be modified Client-side, so now I decided to encrypt them! http://mercury.picoctf.net:56136/

## Notes

First hint mentions [Homomorphic encryption](https://en.wikipedia.org/wiki/Homomorphic_encryption), meaning that maybe I don't have to decrypt the cookie, but I could still use it.

The encrypted cookie on this site is "TGRJdjBtckZtclRFSTdTelQxU0xpZ2lWOFZldHdtMytTQWZQRXpjQlUwQ0VTR2tIaVFHRWVwN2pxQVBQZHFBenJheEhjdUdZTHdJN1AzWVE2WndhV0t0enl5YlFLdzdvTHlZdlRYUklaOXRFbkhzNHc4bHNzR3AwWG5tUmJBcVY".

In the problem the CBC are capitalized, if looking up CBC encryption there are results on [Cipher Block Chaining](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_\(CBC).

## Solution

This is tricky really tricky.  The website itself doesn't tell you much, and the only thing you can really get out of it is the encrypted cookie.  The hints also don't tell you much besides telling you that the encryption method can be modified after its been encrypted.  It's subtle but the best hint is actually in the CBC capitalized, which leads down a path learning about breaking Cipher Block Chaining.

In short the cookie needs to have everyone of its bits flipped and sent to the site, checking if anything is different.  Doing this method, while also accounting for the cookie needs to be decrypted/encrypted twice will make the admin flag found around byte 10.

The flag is picoCTF{cO0ki3s_yum_e491c430}
