# Who are you?

## Problem

Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn *http://mercury.picoctf.net:52362/*

## Notes

### Documentation

This challange is all about understanding the http header that is sent to a webstie when you connect.  The challange links to the page on the [HTTP Protocol Document](https://tools.ietf.org/html/rfc2616).  From this document and knowing a site knows about you from the header you can jump straight to chapters "Response Header Fields" and "General Header Fields".  Another good source, with examples is Wikipedia [List of HTTP header fields](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields).

### Tools

* curl
* Postman

With curl you can send a custom header with the -H flag.

```bash
curl -v http://mercury.picoctf.net:52362/ -H "User-Agent: picoBrowser"
```

Though when the curl command was wrapping to the next line I was having issues with putting new headers in.  So I switched to using Postman, which is nice tool cause Postman will allow me to export to curl at the end.

### Headers

User-Agent: Site mentioned to use its browser, User-Agent is the field that tells a site your browser and OS.  Changing this PicoBrowser solved this.

Referer: Mentioned that it didn't trust outsiders, after much search I tried the Referer header that is mentioned in the http protocal docs.  "The Referer[sic] request-header field allows the client to specify, for the server's benefit, the address (URI) of the resource from which the Request-URI was obtained."  Having the key as the same website as this challange worked.

Date: The site mentioned it has been broken since 2018.  In the general responses in the http protocal docs is a date, taking that date field and adding some date from 2018 works.

DNT: The site says it doesn't like people who are tracked.  I thought this at first was Cache-Control, using that to tell the site not to keep a cache on me.  But the Answer to this was DNT.  THe Do Not Track field wasn't found on the http protocal docs but the wikipedia page.  ON there is other fields and one is on the Mozilla Firefox field DNT for telling sites not to track.

Accept-Language: sv-sv

X-Forwarded-For: Site wanted only People from sweden to connect.  The X-Forwarded-For field is used for HTTP Proxy, and with this field we can say that our current IP is a proxy for someone in Sweden.  To solve this google a sweden IP, the first result will probably contain one that works.

Accept-Language: I actually solved this before the top one as I thought the language was how it determined I was from Sweden.  This is solved by finding what the language code is for Swedish.

## Solution

The entire challange is adding the correct fields to an http header so that eventually the flag is revieled.  The website changes its response based on if the correct flags are used.  Here are all the flags, their values, and the order in which they were found.

* User-Agent: picoBrowser
* Referer: mercury.picoctf.net:52362
* Date: Sat, 29 Oct 2018 19:43:31 GMT
* Cache-Control: no-cache, no-store
* DNT: 1
* Accept-Language: sv-sv
* X-Forwarded-For: *A swedesh IP, just google it*

Here is the final curl command, except for X-Forwarded-For is not going to be an exact IP.

```bash
curl --location --request GET 'http://mercury.picoctf.net:52362/' \
--header 'User-Agent: picoBrowser' \
--header 'Referer: mercury.picoctf.net:52362' \
--header 'Date: Sat, 29 Oct 2018 19:43:31 GMT' \
--header 'DNT: 1' \
--header 'Accept-Language: sv-sv' \
--header 'X-Forwarded-For: swedish.ip.' \
--form 'user="Joe"' \
--form 'password="adfsadfsadf"'
```

Flag: picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_0c0db339}
